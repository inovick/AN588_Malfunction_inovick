---
title: "inovick_OriginalHomeworkCode_04."
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(curl)
f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN588_Fall21/KamilarAndCooperData.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE)
head(d)
```

### Challenge 1
## Write a simple R function that can perform one- or two-sample Z-tests for proportion data
```{r}
#Defining variables
p1 <-[estimated proportion from sample size]
p2 <-NULL
p0 <-expected value of population proportion

n1 <-[samplen]
n2 <-NULL

alternative <- (default “two.sided”)
conf.level <- (default 0.95)
```

## So I think I use the basic format of the prop.test function, but I am struggling to figure out how to fit the parameters into this. Would I use a "for" statement, or an "if/then" situation? Also, would I need to create that exemplar population to draw from? Would I include the parameters for the one tail with phat?
```{r}
#create a population of 500 “1”s and 500 “0”s, i.e., where π = 0.5

pop <- c(rep(0, 500), rep(1, 500))

#prop.test function
prop.test(x, n, p = NULL,
          alternative = c("two.sided", "less", "greater"),
          conf.level = 0.95, correct = F)

#From http://www.sthda.com/english/wiki/two-proportions-z-test-in-r
#running a one proportion z-test  
binom.test(x, n, p = 0.5, alternative = "two.sided")
prop.test(x, n, p = NULL, alternative = "two.sided",
          correct = F)

```

## I think I would need to include these somehow to print the final results once the function is run? I am not sure how to integrate them.
```{r}
# printing the p-value
res$p.value

# printing the confidence interval
res$conf.int

#components of prop.test function:
#statistic: the number of successes
#parameter: the number of trials
#p.value: the p-value of the test
#conf.int: a confidence interval for the probability of success.
#estimate: the estimated probability of success.


#Adjust this for parameters
Z.prop.test()
z.test = function(x,mu,popvar){
one.tail.p <- NULL
z.score <- round((mean(x)-mu)/(popvar/sqrt(length(x))),3)
one.tail.p <- round(pnorm(abs(z.score),lower.tail = FALSE),3)
cat(" z =",z.score,"\n",
"one-tailed probability =", one.tail.p,"\n",
"two-tailed probability =", 2*one.tail.p )}
```

